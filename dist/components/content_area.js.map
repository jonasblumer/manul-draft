{"version":3,"sources":["../../src/components/content_area.jsx"],"names":["MegadraftEditor","Styles","highlightEditable","isEditing","base","outline","padding","margin","cursor","position","enhance","top","left","width","height","ContentArea","className","style","canEdit","blockPluginDialogIsActive","startEditing","cancelEditing","entityInputs","locale","editorState","setEditorState","saveAndClose","saveAndEdit","megadraftActions","blockRenderMap","megadraftBlockPlugins","copyLocales","copyFromLocale","setDimensions","dimensions","editorHasFocus","setEditorHasFocus","styles","renderEditor","readOnly","pointerEvents","Math","max","min","window","innerWidth","innerHeight","display","flexDirection","clear","displayName"],"mappings":"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","file":"content_area.js","sourcesContent":["import { MegadraftEditor as MegadraftEditorOrg } from 'megadraft';\nimport { compose, withState } from 'recompose';\nimport Measure from 'react-measure';\nimport React from 'react';\n\nimport AreaActionsToolbar from './area_actions_toolbar';\nimport DraggableWindow from './draggable_window';\n\n// quickfix for https://github.com/globocom/megadraft/issues/97\nclass MegadraftEditor extends MegadraftEditorOrg {\n  /* eslint class-methods-use-this: 0*/\n  setReadOnly() {\n    // do nothing\n  }\n}\n\nconst Styles = ({ highlightEditable, isEditing }) =>\n   ({\n     base: {\n       ...(highlightEditable ? {\n         outline: '1px dotted black',\n         padding: 15,\n         margin: -15,\n       } : {}),\n       ...(isEditing ? {\n         outline: '1px dotted black',\n         padding: 15,\n         margin: -15,\n       } : {}),\n       cursor: highlightEditable ? 'pointer' : null,\n       position: 'relative',\n     },\n   })\n;\n\nconst enhance = compose(\n  withState('dimensions', 'setDimensions', () => ({ top: 0, left: 0, width: 100, height: 100 })),\n  withState('editorHasFocus', 'setEditorHasFocus', false),\n);\n\nconst ContentArea = enhance(({\n    className,\n    style,\n    canEdit,\n    isEditing,\n    blockPluginDialogIsActive,\n    highlightEditable,\n    startEditing,\n    cancelEditing,\n    entityInputs,\n    locale,\n    editorState,\n    setEditorState,\n    saveAndClose,\n    saveAndEdit,\n    megadraftActions,\n    blockRenderMap,\n    megadraftBlockPlugins = [],\n    copyLocales = [],\n    copyFromLocale,\n    setDimensions,\n    dimensions,\n    editorHasFocus,\n    setEditorHasFocus,\n  }) => {\n  const styles = Styles({ highlightEditable, isEditing });\n\n  const renderEditor = readOnly => (\n    <MegadraftEditor\n      key={`contentId${isEditing ? '_editing' : ''}`} // force rerender\n      actions={megadraftActions}\n      plugins={megadraftBlockPlugins}\n      readOnly={readOnly}\n      editorState={editorState}\n      entityInputs={entityInputs}\n      blockRenderMap={blockRenderMap}\n      onChange={setEditorState}\n    />\n  );\n\n\n  return (\n    <Measure\n      // shouldMeasure={isEditing}\n      onMeasure={setDimensions}\n    >\n      <div style={style} className={className}>\n        <div\n          style={styles.base}\n          onClick={() => canEdit && highlightEditable && startEditing()}\n        >\n          <div style={highlightEditable ? { pointerEvents: 'none' } : null}>\n            {isEditing && (\n            <DraggableWindow\n              disableDragging={editorHasFocus}\n              x={Math.max(20, dimensions.left)}\n              y={Math.max(20, dimensions.top)}\n              /* global window*/\n              width={Math.max(280, Math.min(window.innerWidth - 40, dimensions.width))}\n              height={Math.max(280, Math.min(window.innerHeight - 40, dimensions.height))}\n            >\n              <div\n                onFocus={() => setEditorHasFocus(true)}\n\n                onBlur={() => setEditorHasFocus(false)}\n                className=\"megadraft-floating-window\" style={{\n                  display: 'flex',\n                  cursor: 'text',\n                  flexDirection: 'column',\n                  height: 'calc(100% - 50px)',\n                }}\n              >\n                {renderEditor(blockPluginDialogIsActive || !canEdit || !isEditing)}\n                <AreaActionsToolbar\n                  saveAndClose={saveAndClose}\n                  saveAndEdit={saveAndEdit}\n                  cancelEditing={cancelEditing}\n                  locale={locale}\n                  copyLocales={copyLocales}\n                  copyFromLocale={copyFromLocale}\n                />\n              </div>\n            </DraggableWindow>\n      )}\n            {renderEditor(true)}\n            <div style={{ clear: 'both' }} />\n          </div>\n        </div>\n      </div>\n    </Measure>\n  );\n});\n\n\nContentArea.displayName = 'ContentArea';\n\nexport default ContentArea;\n"]}